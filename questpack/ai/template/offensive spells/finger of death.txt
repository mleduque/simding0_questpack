IF
    OR(2)
		!GlobalTimerNotExpired("CAST","LOCALS")
        CheckStatGT(Myself,0,WIZARD_IMPROVED_ALACRITY)
    HaveSpell(WIZARD_FINGER_OF_DEATH)
    See(NearestEnemyOf(Myself))
    OR(12)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
        HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
        CheckStatLT(NearestEnemyOf(Myself),4,SAVEVSSPELL)
        CheckStatGT(LastSeenBy(Myself),0,SCRIPTINGSTATE2)
        HasItemEquipedReal("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
        CheckStatGT(LastSeenBy(Myself),25,RESISTMAGIC)
        StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
        CheckStat(LastSeenBy(Myself),1,SANCTUARY)
    See(SecondNearestEnemyOf(Myself))
    OR(12)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
        HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
        CheckStatLT(NearestEnemyOf(Myself),4,SAVEVSSPELL)
        CheckStatGT(LastSeenBy(Myself),0,SCRIPTINGSTATE2)
        HasItemEquipedReal("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
        CheckStatGT(LastSeenBy(Myself),25,RESISTMAGIC)
        StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
        CheckStat(LastSeenBy(Myself),1,SANCTUARY)
    See(ThirdNearestEnemyOf(Myself))
    OR(12)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
        HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
        CheckStatLT(NearestEnemyOf(Myself),4,SAVEVSSPELL)
        CheckStatGT(LastSeenBy(Myself),0,SCRIPTINGSTATE2)
        HasItemEquipedReal("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
        CheckStatGT(LastSeenBy(Myself),25,RESISTMAGIC)
        StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
        CheckStat(LastSeenBy(Myself),1,SANCTUARY)
    See(FourthNearestEnemyOf(Myself))
    OR(12)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
        HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
        CheckStatLT(NearestEnemyOf(Myself),4,SAVEVSSPELL)
        CheckStatGT(LastSeenBy(Myself),0,SCRIPTINGSTATE2)
        HasItemEquipedReal("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
        CheckStatGT(LastSeenBy(Myself),25,RESISTMAGIC)
        StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
        CheckStat(LastSeenBy(Myself),1,SANCTUARY)
    See(FifthNearestEnemyOf(Myself))
    OR(12)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
        HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
        CheckStatLT(NearestEnemyOf(Myself),4,SAVEVSSPELL)
        CheckStatGT(LastSeenBy(Myself),0,SCRIPTINGSTATE2)
        HasItemEquipedReal("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
        CheckStatGT(LastSeenBy(Myself),25,RESISTMAGIC)
        StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
        CheckStat(LastSeenBy(Myself),1,SANCTUARY)
    See(SixthNearestEnemyOf(Myself))
    OR(12)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
        HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
        CheckStatLT(NearestEnemyOf(Myself),4,SAVEVSSPELL)
        CheckStatGT(LastSeenBy(Myself),0,SCRIPTINGSTATE2)
        HasItemEquipedReal("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
        CheckStatGT(LastSeenBy(Myself),25,RESISTMAGIC)
        StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
        CheckStat(LastSeenBy(Myself),1,SANCTUARY)
    See(SeventhNearestEnemyOf(Myself))
    OR(12)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
        HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
        CheckStatLT(NearestEnemyOf(Myself),4,SAVEVSSPELL)
        CheckStatGT(LastSeenBy(Myself),0,SCRIPTINGSTATE2)
        HasItemEquipedReal("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
        CheckStatGT(LastSeenBy(Myself),25,RESISTMAGIC)
        StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
        CheckStat(LastSeenBy(Myself),1,SANCTUARY)
    See(EighthNearestEnemyOf(Myself))
    OR(12)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
        HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
        CheckStatLT(NearestEnemyOf(Myself),4,SAVEVSSPELL)
        CheckStatGT(LastSeenBy(Myself),0,SCRIPTINGSTATE2)
        HasItemEquipedReal("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
        CheckStatGT(LastSeenBy(Myself),25,RESISTMAGIC)
        StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
        CheckStat(LastSeenBy(Myself),1,SANCTUARY)
    See(NinthNearestEnemyOf(Myself))
    OR(12)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
        HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
        CheckStatLT(NearestEnemyOf(Myself),4,SAVEVSSPELL)
        CheckStatGT(LastSeenBy(Myself),0,SCRIPTINGSTATE2)
        HasItemEquipedReal("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
        CheckStatGT(LastSeenBy(Myself),25,RESISTMAGIC)
        StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
        CheckStat(LastSeenBy(Myself),1,SANCTUARY)
    See(TenthNearestEnemyOf(Myself))
    OR(12)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
        HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
        CheckStatLT(NearestEnemyOf(Myself),4,SAVEVSSPELL)
        CheckStatGT(LastSeenBy(Myself),0,SCRIPTINGSTATE2)
        HasItemEquipedReal("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
        CheckStatGT(LastSeenBy(Myself),25,RESISTMAGIC)
        StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
        CheckStat(LastSeenBy(Myself),1,SANCTUARY)
    See(NearestEnemyOf(Myself))
    OR(12)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
        HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
        CheckStatLT(NearestEnemyOf(Myself),1,SAVEVSSPELL)
        CheckStatGT(LastSeenBy(Myself),0,SCRIPTINGSTATE2)
        HasItemEquipedReal("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
        CheckStatGT(LastSeenBy(Myself),75,RESISTMAGIC)
        StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
        CheckStat(LastSeenBy(Myself),1,SANCTUARY)
    See(SecondNearestEnemyOf(Myself))
    OR(12)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
        HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
        CheckStatLT(NearestEnemyOf(Myself),1,SAVEVSSPELL)
        CheckStatGT(LastSeenBy(Myself),0,SCRIPTINGSTATE2)
        HasItemEquipedReal("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
        CheckStatGT(LastSeenBy(Myself),75,RESISTMAGIC)
        StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
        CheckStat(LastSeenBy(Myself),1,SANCTUARY)
    See(ThirdNearestEnemyOf(Myself))
    OR(12)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
        HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
        CheckStatLT(NearestEnemyOf(Myself),1,SAVEVSSPELL)
        CheckStatGT(LastSeenBy(Myself),0,SCRIPTINGSTATE2)
        HasItemEquipedReal("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
        CheckStatGT(LastSeenBy(Myself),75,RESISTMAGIC)
        StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
        CheckStat(LastSeenBy(Myself),1,SANCTUARY)
    See(FourthNearestEnemyOf(Myself))
    OR(12)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
        HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
        CheckStatLT(NearestEnemyOf(Myself),1,SAVEVSSPELL)
        CheckStatGT(LastSeenBy(Myself),0,SCRIPTINGSTATE2)
        HasItemEquipedReal("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
        CheckStatGT(LastSeenBy(Myself),75,RESISTMAGIC)
        StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
        CheckStat(LastSeenBy(Myself),1,SANCTUARY)
    See(FifthNearestEnemyOf(Myself))
    OR(12)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
        HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
        CheckStatLT(NearestEnemyOf(Myself),1,SAVEVSSPELL)
        CheckStatGT(LastSeenBy(Myself),0,SCRIPTINGSTATE2)
        HasItemEquipedReal("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
        CheckStatGT(LastSeenBy(Myself),75,RESISTMAGIC)
        StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
        CheckStat(LastSeenBy(Myself),1,SANCTUARY)
    See(SixthNearestEnemyOf(Myself))
    OR(12)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
        HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
        CheckStatLT(NearestEnemyOf(Myself),1,SAVEVSSPELL)
        CheckStatGT(LastSeenBy(Myself),0,SCRIPTINGSTATE2)
        HasItemEquipedReal("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
        CheckStatGT(LastSeenBy(Myself),75,RESISTMAGIC)
        StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
        CheckStat(LastSeenBy(Myself),1,SANCTUARY)
    See(NearestEnemyOf(Myself))
    False()
THEN
    RESPONSE #100
		Continue()
END

IF
    OR(2)
		!GlobalTimerNotExpired("CAST","LOCALS")
        CheckStatGT(Myself,0,WIZARD_IMPROVED_ALACRITY)
    HaveSpell(WIZARD_FINGER_OF_DEATH)
	!CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
    !HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
    !CheckStat(NearestEnemyOf(Myself),0,SCRIPTINGSTATE2)
    !HasItemEquipedReal("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
    CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)
    CheckStatGT(NearestEnemyOf(Myself),0,SAVEVSSPELL)
    !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
    CheckStat(LastSeenBy(Myself),0,SANCTUARY)
THEN
    RESPONSE #100
		SetGlobalTimer("CAST","LOCALS",6)
        Spell(LastSeenBy(Myself),WIZARD_FINGER_OF_DEATH)
END
